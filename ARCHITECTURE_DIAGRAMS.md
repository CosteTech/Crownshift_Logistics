# ğŸ—ºï¸ Admin System Architecture & Flow Diagrams

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CROWNSHIFT LOGISTICS                        â”‚
â”‚                    https://crownshift-main.vercel.app            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CLIENT LAYER (Browser)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Public Page â”‚      â”‚ Public Page  â”‚      â”‚ Public Page  â”‚          â”‚
â”‚  â”‚ (Home)       â”‚      â”‚ (Services)   â”‚      â”‚ (FAQ)        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                     â”‚                     â”‚                  â”‚
â”‚         â”‚                     â”‚                     â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                           â”‚                                            â”‚
â”‚                    [Hidden Footer Link]                               â”‚
â”‚                   Click "[admin]" text                                â”‚
â”‚                           â”‚                                            â”‚
â”‚                           â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚   /login (Login/Signup Form)       â”‚                              â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                              â”‚
â”‚  â”‚  â”‚ Email/Password OR Google      â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ + Full Name                   â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ + Role (Admin/Client)         â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ + Company (Optional)          â”‚  â”‚                              â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚               â”‚                                                        â”‚
â”‚               â”‚ POST /api/auth/create-profile                         â”‚
â”‚               â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚      Receive __session cookie      â”‚                              â”‚
â”‚  â”‚   (Firebase Session Management)    â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚               â”‚                                                        â”‚
â”‚               â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚    /admin (Admin Dashboard)        â”‚                              â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                              â”‚
â”‚  â”‚  â”‚ Sidebar Navigation           â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ â€¢ Dashboard                  â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ â€¢ Services Manager           â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ â€¢ Offers Manager             â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ â€¢ Reviews Manager            â”‚  â”‚                              â”‚
â”‚  â”‚  â”‚ â€¢ Logout                     â”‚  â”‚                              â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚               â”‚                                                        â”‚
â”‚               â”‚ Updates to Firestore                                  â”‚
â”‚               â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚   Content appears on public pages  â”‚                              â”‚
â”‚  â”‚   (Services, Offers, Testimonials) â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MIDDLEWARE LAYER (Edge)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Request Comes In                                                      â”‚
â”‚       â”‚                                                                â”‚
â”‚       â–¼                                                                â”‚
â”‚  Is it /admin?                                                       â”‚
â”‚    â”œâ”€ NO  â†’ Let request through                                      â”‚
â”‚    â”‚       â”œâ”€ API routes                                             â”‚
â”‚    â”‚       â”œâ”€ Static files                                           â”‚
â”‚    â”‚       â””â”€ Public pages                                           â”‚
â”‚    â”‚                                                                 â”‚
â”‚    â””â”€ YES â†’ Check for __session cookie                              â”‚
â”‚           â”œâ”€ Has it? â†’ Allow access to /admin                       â”‚
â”‚           â””â”€ No? â†’ Redirect to /login?callbackUrl=%2Fadmin          â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND LAYER (Node.js)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Firebase Auth                    Firestore Database                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Email/Password   â”‚            â”‚ users/                   â”‚          â”‚
â”‚  â”‚ Google OAuth     â”‚            â”‚   {uid}                  â”‚          â”‚
â”‚  â”‚ Session Tokens   â”‚            â”‚   â”œâ”€ email              â”‚          â”‚
â”‚  â”‚                  â”‚            â”‚   â”œâ”€ fullName           â”‚          â”‚
â”‚  â”‚                  â”‚            â”‚   â”œâ”€ role               â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”œâ”€ company            â”‚          â”‚
â”‚           â”‚                      â”‚   â””â”€ createdAt          â”‚          â”‚
â”‚           â”‚                      â”‚                         â”‚          â”‚
â”‚           â”‚                      â”‚ services/               â”‚          â”‚
â”‚           â”‚                      â”‚   {serviceId}           â”‚          â”‚
â”‚           â”‚                      â”‚   â”œâ”€ title              â”‚          â”‚
â”‚           â”‚                      â”‚   â”œâ”€ description        â”‚          â”‚
â”‚           â”‚                      â”‚   â””â”€ price              â”‚          â”‚
â”‚           â”‚                      â”‚                         â”‚          â”‚
â”‚           â”‚                      â”‚ offers/                 â”‚          â”‚
â”‚           â”‚                      â”‚   {offerId}             â”‚          â”‚
â”‚           â”‚                      â”‚   â”œâ”€ title              â”‚          â”‚
â”‚           â”‚                      â”‚   â”œâ”€ discount           â”‚          â”‚
â”‚           â”‚                      â”‚   â””â”€ expiresAt          â”‚          â”‚
â”‚           â”‚                      â”‚                         â”‚          â”‚
â”‚           â”‚                      â”‚ reviews/                â”‚          â”‚
â”‚           â”‚                      â”‚   {reviewId}            â”‚          â”‚
â”‚           â”‚                      â”‚   â”œâ”€ userId             â”‚          â”‚
â”‚           â”‚                      â”‚   â”œâ”€ rating             â”‚          â”‚
â”‚           â”‚                      â”‚   â””â”€ text               â”‚          â”‚
â”‚           â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚           â”‚                                                            â”‚
â”‚           â”‚                  API Routes                               â”‚
â”‚           â”‚                  /api/auth/create-profile                â”‚
â”‚           â”‚                  /api/contact                            â”‚
â”‚           â”‚                                                           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Authentication Flow

```
START
  â”‚
  â–¼
Is user on /admin?
  â”‚
  â”œâ”€ NO â†’ Show public page
  â”‚        END
  â”‚
  â””â”€ YES â†’ Check __session cookie
           â”‚
           â”œâ”€ HAS COOKIE
           â”‚   â””â”€ Token valid?
           â”‚       â”œâ”€ YES â†’ ALLOW âœ“
           â”‚       â”‚        Show /admin
           â”‚       â”‚        END
           â”‚       â”‚
           â”‚       â””â”€ NO â†’ DENY
           â”‚               Redirect to /login
           â”‚               (continue below)
           â”‚
           â””â”€ NO COOKIE â†’ DENY
                          Redirect to /login
                          â”‚
                          â–¼
                    /login Page
                    â”‚
                    â”œâ”€ Sign In Form
                    â”‚   â””â”€ Email + Password
                    â”‚       â”‚
                    â”‚       â–¼
                    â”‚   Firebase Auth
                    â”‚       â”‚
                    â”‚       â”œâ”€ Success
                    â”‚       â”‚   â””â”€ Set __session
                    â”‚       â”‚       Redirect to /admin
                    â”‚       â”‚       END
                    â”‚       â”‚
                    â”‚       â””â”€ Fail
                    â”‚           Show error
                    â”‚           Back to form
                    â”‚
                    â””â”€ Sign Up Form
                        â””â”€ Email + Password
                            + Full Name
                            + Role
                            + Company
                            â”‚
                            â–¼
                        Firebase Auth
                        Create User
                            â”‚
                            â–¼
                        POST /api/auth/create-profile
                        Save to Firestore users/
                            â”‚
                            â”œâ”€ Success
                            â”‚   Set __session
                            â”‚   Redirect to /admin
                            â”‚   END
                            â”‚
                            â””â”€ Fail (but auth success)
                                Still set __session
                                Redirect to /admin
                                (profile saved asynchronously)
```

---

## Admin Content Management Flow

```
Admin Dashboard
  â”‚
  â”œâ”€ Services Manager
  â”‚   â”‚
  â”‚   â”œâ”€ View all services
  â”‚   â”‚   â””â”€ From Firestore: services/
  â”‚   â”‚
  â”‚   â”œâ”€ Add New Service
  â”‚   â”‚   â””â”€ Form: title, description, price
  â”‚   â”‚       â”‚
  â”‚   â”‚       â–¼
  â”‚   â”‚   Firestore: services/{newId}
  â”‚   â”‚       â”‚
  â”‚   â”‚       â–¼
  â”‚   â”‚   Appears on /client/services page
  â”‚   â”‚
  â”‚   â””â”€ Edit/Delete Service
  â”‚       â””â”€ Update Firestore
  â”‚           â””â”€ Changes live immediately
  â”‚
  â”œâ”€ Offers Manager
  â”‚   â”‚
  â”‚   â”œâ”€ View all offers
  â”‚   â”‚   â””â”€ From Firestore: offers/
  â”‚   â”‚
  â”‚   â”œâ”€ Add New Offer
  â”‚   â”‚   â””â”€ Form: title, discount, expiry
  â”‚   â”‚       â”‚
  â”‚   â”‚       â–¼
  â”‚   â”‚   Firestore: offers/{newId}
  â”‚   â”‚       â”‚
  â”‚   â”‚       â–¼
  â”‚   â”‚   Appears on homepage carousel
  â”‚   â”‚
  â”‚   â””â”€ Edit/Delete Offer
  â”‚       â””â”€ Update Firestore
  â”‚
  â”œâ”€ Reviews Manager
  â”‚   â”‚
  â”‚   â”œâ”€ View pending reviews
  â”‚   â”‚   â””â”€ From Firestore: reviews/ (approved=false)
  â”‚   â”‚
  â”‚   â”œâ”€ Approve Review
  â”‚   â”‚   â””â”€ Set approved=true
  â”‚   â”‚       â”‚
  â”‚   â”‚       â–¼
  â”‚   â”‚   Appears on /testimonials page
  â”‚   â”‚
  â”‚   â””â”€ Reject/Delete Review
  â”‚       â””â”€ Remove from Firestore
  â”‚
  â””â”€ Dashboard
      â”‚
      â”œâ”€ Statistics
      â”‚   â”œâ”€ Total users
      â”‚   â”œâ”€ Total bookings
      â”‚   â””â”€ Revenue
      â”‚
      â””â”€ Recent activity
          â”œâ”€ New signups
          â”œâ”€ New reviews
          â””â”€ New bookings
```

---

## Database Schema

```
Firestore
â”‚
â”œâ”€â”€ users/ (auto-created on signup)
â”‚   â”‚
â”‚   â””â”€â”€ {uid}
â”‚       â”œâ”€â”€ email: string
â”‚       â”œâ”€â”€ fullName: string
â”‚       â”œâ”€â”€ role: "admin" | "client"
â”‚       â”œâ”€â”€ company: string (optional)
â”‚       â”œâ”€â”€ createdAt: timestamp
â”‚       â””â”€â”€ updatedAt: timestamp
â”‚
â”œâ”€â”€ services/
â”‚   â”‚
â”‚   â””â”€â”€ {serviceId}
â”‚       â”œâ”€â”€ title: string
â”‚       â”œâ”€â”€ description: string
â”‚       â”œâ”€â”€ price: number
â”‚       â”œâ”€â”€ slug: string
â”‚       â””â”€â”€ createdAt: timestamp
â”‚
â”œâ”€â”€ offers/
â”‚   â”‚
â”‚   â””â”€â”€ {offerId}
â”‚       â”œâ”€â”€ title: string
â”‚       â”œâ”€â”€ description: string
â”‚       â”œâ”€â”€ discount: number
â”‚       â”œâ”€â”€ validFrom: timestamp
â”‚       â”œâ”€â”€ validTo: timestamp
â”‚       â”œâ”€â”€ active: boolean
â”‚       â””â”€â”€ createdAt: timestamp
â”‚
â”œâ”€â”€ reviews/
â”‚   â”‚
â”‚   â””â”€â”€ {reviewId}
â”‚       â”œâ”€â”€ userId: string (ref to users/)
â”‚       â”œâ”€â”€ rating: 1-5
â”‚       â”œâ”€â”€ text: string
â”‚       â”œâ”€â”€ approved: boolean
â”‚       â”œâ”€â”€ createdAt: timestamp
â”‚       â””â”€â”€ updatedAt: timestamp
â”‚
â””â”€â”€ bookings/
    â”‚
    â””â”€â”€ {bookingId}
        â”œâ”€â”€ userId: string (ref to users/)
        â”œâ”€â”€ serviceId: string (ref to services/)
        â”œâ”€â”€ origin: string
        â”œâ”€â”€ destination: string
        â”œâ”€â”€ status: string
        â”œâ”€â”€ totalPrice: number
        â””â”€â”€ createdAt: timestamp
```

---

## Security & Access Control

```
                          Request
                            â”‚
                            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚   Middleware   â”‚
                     â”‚   (Edge)       â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                       â”‚
          Protected Route          Public Route
          (/admin, etc.)           (/, /services)
                â”‚                       â”‚
                â–¼                       â–¼
         Check Cookie?             No Check
                â”‚                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
        â”‚                â”‚             â”‚
       YES               NO            â”‚
        â”‚                â”‚             â”‚
        â–¼                â–¼             â”‚
    Token Valid?   Redirect           â”‚
        â”‚            /login           â”‚
        â”œâ”€YESâ”                        â”‚
        â”‚    â”‚                        â”‚
        â–¼    â–¼ Provide                â”‚
      ALLOW callbackUrl   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         User Logs In
              â”‚
         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
         â”‚          â”‚
      Email       Google OAuth
         â”‚          â”‚
         â–¼          â–¼
    Firebase Auth
         â”‚
         â”œâ”€ Success
         â”‚   â””â”€ Create __session
         â”‚       â””â”€ Create user profile
         â”‚           â””â”€ Redirect to callbackUrl
         â”‚
         â””â”€ Fail
             â””â”€ Show error
                 â””â”€ Retry

FIRESTORE RULES:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Services/Offers: Public Read, Admin Writeâ”‚
â”‚ Reviews: Public Read, User Create, Admin â”‚
â”‚          Update                          â”‚
â”‚ Users: Private Read/Write (self only)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Architecture

```
                    GitHub/Local
                         â”‚
                         â”‚ git push
                         â–¼
                    Vercel Git
                    Integration
                         â”‚
                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                    â”‚          â”‚
              Build & Test   Automatic
              (npm run       Redeploy
               build)            â”‚
                    â”‚            â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   Edge Docs  â”‚
                   â”‚ (middleware) â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                     â”‚
              â–¼                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Next.js     â”‚      â”‚ API Routes â”‚
        â”‚ App Router  â”‚      â”‚ (Node.js)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                    â”‚          â”‚
                Firebase      Vercel
                Database      Analytics
                (Firestore)      â”‚
                    â”‚            â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
            https://crownshift-main.vercel.app
```

---

**All systems are integrated and production-ready!** ğŸš€
